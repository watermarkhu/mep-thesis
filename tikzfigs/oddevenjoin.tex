\begin{figure}[htbp]
    \centering
    \tikzstyle{undef}=[node1, dotted, pattern=dots, pattern color=black!25!white]
    \begin{tikzpicture}[on grid]
      \node (o1) [even] at (1.5, 1) {$s_1$};
      \node (o2) [even] at (1, 0) {$s_2$};
      \node (o3) [even] at (2, 0) {$s_3$};
      \node (e4) [undef] at (3.5,1) {$s_4$};
      \node (e5) [undef] at (3.5,0) {$s_5$};
      \draw[l1] (o2) -- (o1) -- (o3) (e4) -- (e5);
      \draw[l1, dashed] (o3) -- (e5) node[midway,below] (a) {};
      \draw[l1, <-] (a) -- ++(0,-.5) node[below] {$\codefunc{Join}(s_3, s_5)$};
    
      \begin{scope}[shift={(4.5,1)}]
      \node (o1) [even] at (1.5, 1) {$s_1$};
      \node (o2) [even] at (1, 0) {$s_2$};
      \node (o3) [even] at (2, 0) {$s_3$};
      \node (e4) [undef] at (2,-2) {$s_4$};
      \node (e5) [undef] at (2,-1) {$s_5$};
      \draw[l1] (o2) -- (o1) -- (o3) -- (e5) -- (e4);
      \draw[l1, ->, dashed, color=mblue] (e4) ++(-.7,0) -- + (0,1);
      \draw[l1, ->, color=mred] (o3) ++(.7,-.5) -- +(0,-1.5);
      \end{scope}
    
      \begin{scope}[shift={(9,1.5)}]
      \node (o1) [undef] at (1, -2) {$s_1$};
      \node (o2) [undef] at (1, -3) {$s_2$};
      \node (o3) [undef] at (1, -1) {$s_3$};
      \node (e4) [undef] at (1,1) {$s_4$};
      \node (e5) [undef] at (1,0) {$s_5$};
      \draw[l1] (o2) -- (o1) -- (o3) -- (e5) -- (e4);
      \draw[l1, ->, dashed, color=mblue] (o2) ++(-.7,0) -- +(0,4);
      \draw[l1, ->, color=mred] (e4) ++(.7,0) -- +(0,-4);
      \end{scope}
    
      \node at (1,2) {\emph{(a)}};
      \node at (4,2) {\emph{(b)}};
      \node at (8.5,2) {\emph{(c)}};
      \path (12.5, 2) node[even] {} -- +(.5,0) node[anchor=west]{$n.p$ even};
      \path (12.5, 1) node[undef] {} -- +(.5,0) node[anchor=west]{$n.p$ undefined};
      \draw[l1, ->, color=mred] (12.25, -1) -- ++(0.5,0);
      \node[color=mred, anchor=west] at (13,-1) {Calcdelay};
      \draw[l1, ->, color=mblue, dashed] (12.25, 0) -- ++(0.5,0);
      \node[color=mblue, anchor=west] at (13,0) {Calcparity};
    \end{tikzpicture}
    \caption{(a) An odd cluster $\nset^o=\{s_1, s_2, s_3\}$ with root $n^o_r = s_1$ joins with an even cluster $\nset^e=\{s_4, s_5\}$ with root $n^e_r=s_4$ on nodes $s_3, s_5$, respectively, to a new set $\nset$ with subsets $'\nset^e$ and $'\nset^o$.  If we choose to (b), make $s_5$ a child of $s_3$, the parities and delays in $'\nset^o$ can be reused, and we only have perform partial parity and delay calculations over $'\nset^e$. If we choose to (c), make $s_3$ a child of $s_5$, parities and delays have to be recalculated over both $'\nset^2e$ and $'\nset^o$}\label{fig:joinrules}
\end{figure}