\documentclass[11pt, a4paper, twoside, titlepage, dvipsnames]{report}
\usepackage[page, toc]{appendix}
\usepackage[a4paper, total={6in, 8in}]{geometry}
\usepackage[section]{placeins}
\usepackage[utf8]{inputenc}
\usepackage[hidelinks]{hyperref}
\usepackage[mathscr]{euscript}
\usepackage[table]{xcolor}
\usepackage{physics, adjustbox}
\usepackage{amsfonts, amsmath, amssymb, amsthm}
\usepackage{framed,enumitem} 
\usepackage{xparse, todonotes}
\usepackage{titlesec}
\usepackage{cleveref}

% Define colors
\definecolor{mblue}{HTML}{1F77B4}
\definecolor{morange}{HTML}{FF7F0E}
\definecolor{mgreen}{HTML}{2CA02C}
\definecolor{mred}{HTML}{D62728}
\definecolor{mpurple}{HTML}{9467BD}
\definecolor{mbrown}{HTML}{8C564B}
\definecolor{mpink}{HTML}{E377C2}
\definecolor{mgrey}{HTML}{7F7F7F}
\definecolor{mlime}{HTML}{BCBD22}
\definecolor{mcyan}{HTML}{17BECF}


% Set math environments
\setlength{\parindent}{24pt}
\newtheorem{definition}{Definition}[chapter]
\newtheorem{lemma}{Lemma}[chapter]
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{proposition}{Proposition}[chapter]

% Set new commands
\newcommand{\codeword}[1]{\texttt{\textcolor{MidnightBlue}{#1}}}
%\newcommand{\codefunc}[1]{\texttt{\textcolor{OliveGreen}{#1}}}
\let\oldemptyset\emptyset
\let\emptyset\varnothing
\newcommand{\codefunc}[1]{\texttt{#1}}
\newcommand{\m}[1]{\mathcal{#1}}
\newcommand{\n}[1]{\mathscr{#1}}
\newcommand{\bound}{\mathscr{B}}
\newcommand{\akker}{\mathscr{A}}
\newcommand{\nset}{\mathcal{N}}
\newcommand{\vset}{\mathcal{V}}
\newcommand{\pre}[1]{ {}^{#1} }
\newcommand{\ceil}[1]{{\left \lceil #1 \right \rceil }}
\newcommand{\floor}[1]{{\left \lfloor #1 \right \rfloor }}


% Set graphics folder
\usepackage{float}
\usepackage{graphicx}
\usepackage[format=plain, font=it]{caption}
\usepackage[format=plain, font=it]{subcaption}
\graphicspath{{"/home/watermarkhu/links/onedriveuni/MEP - thesis Mark/Figures/ch_toric_code/"}}

% Set algorithm2e package settings
\usepackage[linesnumbered, vlined, boxruled]{algorithm2e}
\SetAlgoCaptionLayout{centerline}
\setlength{\algoheightrule}{1pt}
\setlength{\algotitleheightrule}{1pt}
\setlength{\interspacetitleboxruled}{.5em}
\SetStartEndCondition{ }{}{}
\SetKwProg{Fn}{def}{\string:}{}
\SetKw{KwTo}{in}
\SetKwFor{For}{for}{\string:}{}
\SetKwIF{If}{ElseIf}{Else}{if}{ then}{else if}{else}{}
\SetKwFor{While}{while}{ do}{}
\SetAlgoNoEnd\DontPrintSemicolon

% Set algorithm title custom box
\usepackage[most]{tcolorbox}
\tcbset{algotitle/.style={title={ \strut Algorithm~\thetcbcounter\ifstrempty{#1}{\ignorespaces}{:~#1}}}}
\newtcolorbox[auto counter]{algo}[1][]{
    colback=white, colframe=black, boxrule=0.5pt,
    titlerule=0pt, sharp corners, colbacktitle=white,enhanced,
    attach boxed title to top center={yshift=-10pt},
    boxed title style={boxrule=-1pt},
    fonttitle=\bfseries, coltitle=black, algotitle={}, #1}


% listings of pseudo-codes
\usepackage{listings}
\lstset{language=C,keywordstyle={\bfseries \color{blue}}}

\usepackage{tikz, pgfplots}
\usepgfplotslibrary{groupplots,dateplot}
\usetikzlibrary{quantikz,shapes,calc,math,patterns,arrows}
\def\checkmark{\tikz\fill[scale=0.4](0,.35) -- (.25,0) -- (1,.7) -- (.25,.15) -- cycle;}
\SetAlFnt{\footnotesize}
\tikzset{bellstar/.style ={draw, star,star points = 8, star point height = 1em, star point ratio = 1.8, minimum size = 1em, inner sep = 0pt}}
\tikzset{selection/.style={draw, signal, signal to =south, minimum size = 1em, inner sep = 0pt}}
\tikzset{sel/.style={label position = below, yshift = 0.5cm}}

\DeclareUnicodeCharacter{2212}{âˆ’}  
\pgfplotsset{compat=newest}


% Glossary
\usepackage[symbols,nomain,automake]{glossaries-extra}
\usepackage{glossary-mcols}

\makeglossaries
\input{gls_symbols.tex}

\renewcommand*{\glossarypreamble}{\vspace{-\baselineskip}}
\newcommand*{\Ngroupname}{Objects, elements of sets}
\newcommand*{\Ogroupname}{Operators}
\newcommand*{\Sgroupname}{Sets and groups}
\newcommand*{\Pgroupname}{Set operations}
\newcommand*{\Zgroupname}{Others}

% Referencing
\usepackage[style=numeric-comp, sorting=none]{biblatex}
\addbibresource{cit.bib}

% Tables
\usepackage{tabularx, hhline, multirow} 
\newcolumntype{L}[1]{>{\hsize=#1\hsize\raggedright\arraybackslash}X}%
\newcolumntype{R}[1]{>{\hsize=#1\hsize\raggedleft\arraybackslash}X}%
\newcolumntype{C}[1]{>{\hsize=#1\hsize\centering\arraybackslash}X}%
\newcommand{\gc}{\cellcolor[gray]{0.9}}

\title{mep-thesis}
\author{Shui Hu}
\date{April 2019}


\begin{document}

    \input{tikzfigs/function_draw_lattices}

    \def\QS{15}
    \def\s{1.5}
    \def\lw{0.5}


    \begin{tikzpicture}
        \DRAWTORIC{3}
    \end{tikzpicture}
    \begin{tikzpicture}
        \DRAWTORIC{4}
        \DRAWERROR{1}{2}{0}{z}
        \DRAWERROR{2}{0}{0}{z}
        \DRAWERROR{1}{0}{0}{z}
        \DRAWSTAR{1}{2}{5}
        \DRAWSTAR{2}{2}{5}
        \DRAWSTAR{1}{0}{5}
        \DRAWSTAR{3}{0}{5}
        \begin{pgfonlayer}{edges}
            \draw[synz] (N-1-0-0) -- (N-2-0-0);
        \end{pgfonlayer}
    \end{tikzpicture}
    \newline
    \begin{tikzpicture}
        \DRAWTORIC{4}
        \DRAWSTAR{1}{2}{5}
        \DRAWSTAR{2}{2}{5}
        \DRAWSTAR{1}{0}{5}
        \DRAWSTAR{3}{0}{5}
    \end{tikzpicture}

    \tikzstyle{rednode}=[circle, fill=red!50, minimum size=4]
    \tikzstyle{bluenode}=[circle, fill=cyan!50, minimum size=4]
    \tikzstyle{redline}=[red!50, line width = 2]
    \tikzstyle{blueline}=[cyan!50, line width = 2]
    \tikzstyle{legend}=[anchor=west, font=\small]

    \newcommand{\drawquasigrid}{
    \draw[step=.4cm, opacity=.25] (0,-.8) grid (4,3.2);
    \draw (0,-.8) rectangle (4,3.2);
    \node[rednode] (N1) at (0.5,0.4) {};
    \node[rednode] (N2) at (2,0.7) {};
    \node[rednode] (N3) at (2.5,1.2) {};
    \node[rednode] (N4) at (3.6,1) {};
    \node[rednode] (N5) at (0.75,2.1) {};
    \node[rednode] (N6) at (1.95,1.8) {};
    \draw[blueline] (N1) to[in=170, out=20] (N2);
    \draw[blueline] (N3) to[in=180, out=-10] (N4);
    \draw[blueline] (N5) to[in=170, out=-20] (N6);
    }
    \begin{figure}[htbp]
        \centering
        \begin{tikzpicture}[scale=0.9]
            \drawquasigrid
        \end{tikzpicture}
        \hspace{.3cm}
        \begin{tikzpicture}[scale=0.9]
            \drawquasigrid
            \draw[dashed, blueline] (N1) to[out=90, in=270] (N5);
            \draw[dashed, blueline] (N2) to[out=80, in=275] (N6);
            \draw[dashed, blueline] (N3) to[out=10, in=160] (N4);
        \end{tikzpicture}
        \hspace{.3cm}
        \begin{tikzpicture}[scale=0.9]
        \drawquasigrid
            \draw[yellow, line width=6, opacity=.3] (N3) to[in=180, out=-10] (N4);
            \draw[yellow, line width=6, opacity=.3] (N5) to[in=170, out=-20] (N6);
            \draw[yellow, line width=6, opacity=.3] (N3) to[out=120, in=-30] (N6);
            \draw[yellow, line width=6, opacity=.3] (N5) to[out=200, in=45] (0, 1.75);
            \draw[yellow, line width=6, opacity=.3] (N4) to[out=80, in=225] (4, 1.75);
            \draw[dashed, blueline] (N1) to[out=0, in=200] (N2);
            \draw[dashed, blueline] (N3) to[out=120, in=-30] (N6);
            \draw[dashed, blueline] (N5) to[out=200, in=45] (0, 1.75);
            \draw[dashed, blueline] (N4) to[out=80, in=225] (4, 1.75);
        \end{tikzpicture}

    \end{figure}


    \def\QS{4}
    \def\s{1.5}
    \def\lw{0.5}
    \begin{tikzpicture}[scale=0.5]
        \DRAWTORIC{8}
    \end{tikzpicture}

    \def\QS{0.15}
    \def\s{1.5}
    \def\lw{0.5}
    \begin{tikzpicture}[scale=0.4]
        \DRAWTORIC{24}
    \end{tikzpicture}

\end{document}